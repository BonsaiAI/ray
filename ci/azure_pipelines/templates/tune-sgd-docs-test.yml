# This template includes the steps of the Tune/SGD/Docs Tests and examples in travix.yml

steps:
- bash: |
    echo Running install phase of the original travis.yml

    # Set some variables to make the system looks like Travis
    source $BUILD_SOURCESDIRECTORY/ci/azure_pipelines/templates/travis-legacy/pre-install.sh

    # Start Original script

    # install part
    . ./ci/travis/ci.sh init RAY_CI_TUNE_AFFECTED,RAY_CI_SGD_AFFECTED
    . ./ci/travis/ci.sh build

    # script part
    bazel test --config=ci --build_tests_only --test_tag_filters=py37 python/ray/tune/...
    # There are no python 3.7 tests for RaySGD/Docs at the moment
    # bazel test --config=ci --build_tests_only --test_tag_filters=py37 python/ray/util/sgd/...
    # bazel test --config=ci --build_tests_only --test_tag_filters=py37 doc/...

    # End Original script

    exit 0
  env:
    PYTHONWARNINGS: 'ignore'
    TRAVIS: 'true'
    TUNE_TESTING: 1
    TF_VERSION: 2.1.0
    TFP_VERSION: 0.8
    TORCH_VERSION: 1.5
  displayName: 'Run original Tune/SGD/Docs tests and examples'
  timeoutInMinutes: 120
